services:
  zookeeper:
    image: confluentinc/cp-zookeeper:7.6.1
    container_name: zookeeper
    restart: unless-stopped
    environment:
      ZOOKEEPER_CLIENT_PORT: 2181
      ZOOKEEPER_TICK_TIME: 2000
    ports: ["127.0.0.1:2181:2181"]
    networks: [ocean-net-data]

  # ğŸ”„ ì¹´í”„ì¹´ ë¸Œë¡œì»¤ 1 (ë¦¬ë” ë¸Œë¡œì»¤)
  kafka1:
    image: confluentinc/cp-kafka:7.6.1
    restart: unless-stopped
    depends_on: [zookeeper]
    hostname: kafka1
    container_name: kafka1
    ports: ["9092:9092"]   # ë¸Œë¡œì»¤1 ì ‘ê·¼ìš© (ëª¨ë“  ì¸í„°í˜ì´ìŠ¤)
    environment:
      # ë¸Œë¡œì»¤ 1 ê¸°ë³¸ ì„¤ì •
      KAFKA_BROKER_ID: 1                                    # ë¸Œë¡œì»¤ ê³ ìœ  ID (ì²« ë²ˆì§¸ ë¸Œë¡œì»¤)
      KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181               # ì£¼í‚¤í¼ ì—°ê²° ì •ë³´

      # ë„¤íŠ¸ì›Œí¬ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
      KAFKA_LISTENERS: INTERNAL://0.0.0.0:29092,EXTERNAL://0.0.0.0:9092              # ë°”ì¸ë”©í•  ì£¼ì†Œ
      KAFKA_ADVERTISED_LISTENERS: INTERNAL://kafka1:29092,EXTERNAL://${HOST_IP}:9092  # í´ë¼ì´ì–¸íŠ¸ì— ì•Œë¦´ ì£¼ì†Œ
      KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: INTERNAL:PLAINTEXT,EXTERNAL:PLAINTEXT     # ë³´ì•ˆ í”„ë¡œí† ì½œ ë§¤í•‘
      KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL                                      # ë¸Œë¡œì»¤ê°„ í†µì‹ ìš© ë¦¬ìŠ¤ë„ˆ

      # ğŸ”„ 2ë°° ì €ì¥ì„ ìœ„í•œ ë³µì œ ì„¤ì •
      KAFKA_DEFAULT_REPLICATION_FACTOR: 2                  # ëª¨ë“  í† í”½ 2ë°° ë³µì œ
      KAFKA_MIN_INSYNC_REPLICAS: 1                         # ìµœì†Œ 1ê°œ ë³µì œë³¸ ë™ê¸°í™” í•„ìš”
      KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 2            # __consumer_offsets í† í”½ë„ 2ë°° ë³µì œ
      KAFKA_TRANSACTION_STATE_LOG_REPLICATION_FACTOR: 2    # íŠ¸ëœì­ì…˜ ë¡œê·¸ë„ 2ë°° ë³µì œ
      KAFKA_TRANSACTION_STATE_LOG_MIN_ISR: 1               # íŠ¸ëœì­ì…˜ ë¡œê·¸ ìµœì†Œ ISR

      # ë¡œê·¸ ë¶„ì‚° ì €ì¥ ì„¤ì •
      KAFKA_AUTO_CREATE_TOPICS_ENABLE: true                # ìë™ í† í”½ ìƒì„± í™œì„±í™”
      KAFKA_NUM_PARTITIONS: 4                              # ê¸°ë³¸ íŒŒí‹°ì…˜ ìˆ˜ (ë¶„ì‚° ì²˜ë¦¬ìš©)
      KAFKA_GROUP_INITIAL_REBALANCE_DELAY_MS: 3000         # ë¸Œë¡œì»¤ 2ê°œ ëŒ€ê¸° ì‹œê°„

      KAFKA_LOG_DIRS: /var/lib/kafka/data                  # ë¡œê·¸ ì €ì¥ ë””ë ‰í† ë¦¬

      # JMX ë©”íŠ¸ë¦­ ì„¤ì • (ë¹„í™œì„±í™”)
      # KAFKA_JMX_HOSTNAME: kafka1
      # KAFKA_JMX_PORT: 9998
      # KAFKA_OPTS: "-javaagent:/opt/jmx_prometheus_javaagent.jar=7071:/opt/jmx-exporter.yml"
    volumes:
      - ./data/kafka1:/var/lib/kafka/data                  # ë¸Œë¡œì»¤1 ì „ìš© ë°ì´í„° ë””ë ‰í† ë¦¬
      # - ./config/jmx-exporter.yml:/opt/jmx-exporter.yml:ro
      # - ./jmx_prometheus_javaagent.jar:/opt/jmx_prometheus_javaagent.jar:ro
    networks: [ocean-net-data]

  # ğŸ”„ ì¹´í”„ì¹´ ë¸Œë¡œì»¤ 2 (íŒ”ë¡œì›Œ ë¸Œë¡œì»¤)
  kafka2:
    image: confluentinc/cp-kafka:7.6.1
    restart: unless-stopped
    depends_on: [zookeeper]
    hostname: kafka2
    container_name: kafka2
    ports: ["9093:9092"]   # ë¸Œë¡œì»¤2 ì ‘ê·¼ìš© (ëª¨ë“  ì¸í„°í˜ì´ìŠ¤)
    environment:
      # ë¸Œë¡œì»¤ 2 ê¸°ë³¸ ì„¤ì •
      KAFKA_BROKER_ID: 2                                    # ë¸Œë¡œì»¤ ê³ ìœ  ID (ë‘ ë²ˆì§¸ ë¸Œë¡œì»¤)
      KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181               # ì£¼í‚¤í¼ ì—°ê²° ì •ë³´

      # ë„¤íŠ¸ì›Œí¬ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
      KAFKA_LISTENERS: INTERNAL://0.0.0.0:29092,EXTERNAL://0.0.0.0:9092              # ë°”ì¸ë”©í•  ì£¼ì†Œ
      KAFKA_ADVERTISED_LISTENERS: INTERNAL://kafka2:29092,EXTERNAL://${HOST_IP}:9093  # í´ë¼ì´ì–¸íŠ¸ì— ì•Œë¦´ ì£¼ì†Œ (ë‹¤ë¥¸ í¬íŠ¸)
      KAFKA_LISTENER_SECURITY_PROTOCOL_MAP: INTERNAL:PLAINTEXT,EXTERNAL:PLAINTEXT     # ë³´ì•ˆ í”„ë¡œí† ì½œ ë§¤í•‘
      KAFKA_INTER_BROKER_LISTENER_NAME: INTERNAL                                      # ë¸Œë¡œì»¤ê°„ í†µì‹ ìš© ë¦¬ìŠ¤ë„ˆ

      # ğŸ”„ ë¸Œë¡œì»¤1ê³¼ ë™ì¼í•œ ë³µì œ ì„¤ì • (í•„ìˆ˜!)
      KAFKA_DEFAULT_REPLICATION_FACTOR: 2                  # ëª¨ë“  í† í”½ 2ë°° ë³µì œ
      KAFKA_MIN_INSYNC_REPLICAS: 1                         # ìµœì†Œ 1ê°œ ë³µì œë³¸ ë™ê¸°í™” í•„ìš”
      KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 2            # __consumer_offsets í† í”½ë„ 2ë°° ë³µì œ
      KAFKA_TRANSACTION_STATE_LOG_REPLICATION_FACTOR: 2    # íŠ¸ëœì­ì…˜ ë¡œê·¸ë„ 2ë°° ë³µì œ
      KAFKA_TRANSACTION_STATE_LOG_MIN_ISR: 1               # íŠ¸ëœì­ì…˜ ë¡œê·¸ ìµœì†Œ ISR

      # ë¡œê·¸ ë¶„ì‚° ì €ì¥ ì„¤ì • (ë¸Œë¡œì»¤1ê³¼ ë™ì¼)
      KAFKA_AUTO_CREATE_TOPICS_ENABLE: true                # ìë™ í† í”½ ìƒì„± í™œì„±í™”
      KAFKA_NUM_PARTITIONS: 4                              # ê¸°ë³¸ íŒŒí‹°ì…˜ ìˆ˜ (ë¶„ì‚° ì²˜ë¦¬ìš©)
      KAFKA_GROUP_INITIAL_REBALANCE_DELAY_MS: 3000         # ë¸Œë¡œì»¤ 2ê°œ ëŒ€ê¸° ì‹œê°„

      KAFKA_LOG_DIRS: /var/lib/kafka/data                  # ë¡œê·¸ ì €ì¥ ë””ë ‰í† ë¦¬

      # JMX ë©”íŠ¸ë¦­ ì„¤ì • (ë¹„í™œì„±í™”)
      # KAFKA_JMX_HOSTNAME: kafka2
      # KAFKA_JMX_PORT: 9999
      # KAFKA_OPTS: "-javaagent:/opt/jmx_prometheus_javaagent.jar=7072:/opt/jmx-exporter.yml"
    volumes:
      - ./data/kafka2:/var/lib/kafka/data                  # ë¸Œë¡œì»¤2 ì „ìš© ë°ì´í„° ë””ë ‰í† ë¦¬
      # - ./config/jmx-exporter.yml:/opt/jmx-exporter.yml:ro
      # - ./jmx_prometheus_javaagent.jar:/opt/jmx_prometheus_javaagent.jar:ro
    networks: [ocean-net-data]

  # ğŸ”„ MinIO ë¶„ì‚° ëª¨ë“œ ì„¤ì • (4ê°œ ë…¸ë“œ ê¶Œì¥)
  minio1:
    image: minio/minio:latest
    restart: unless-stopped
    hostname: minio1
    container_name: minio1
    environment:
      # MinIO ë¶„ì‚° í´ëŸ¬ìŠ¤í„° ì¸ì¦ ì„¤ì •
      MINIO_ROOT_USER: ${MINIO_ROOT_USER}           # ê´€ë¦¬ì ì‚¬ìš©ìëª… (ëª¨ë“  ë…¸ë“œ ë™ì¼í•´ì•¼ í•¨)
      MINIO_ROOT_PASSWORD: ${MINIO_ROOT_PASSWORD}   # ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ (ëª¨ë“  ë…¸ë“œ ë™ì¼í•´ì•¼ í•¨)
      MINIO_PROMETHEUS_AUTH_TYPE: public
      MINIO_PROMETHEUS_URL: http://prometheus:9090  # í”„ë¡œë©”í…Œìš°ìŠ¤ ì„œë²„ URL

      # ğŸ“ ë¶„ì‚° ëª¨ë“œ í•„ìˆ˜ ì„¤ì •
      # MINIO_DISTRIBUTED_MODE_ENABLED: yes          # ë¶„ì‚° ëª¨ë“œ í™œì„±í™” (ìë™ ê°ì§€ë¨)
      # MINIO_DISTRIBUTED_NODES: 4                   # ì´ ë…¸ë“œ ìˆ˜ (erasure codingìš©)

      # ğŸ“ ë¶„ì‚° ëª¨ë“œ ì¶”ê°€ ì„¤ì •
      # MINIO_REGION_NAME: us-east-1                 # ê¸°ë³¸ ë¦¬ì „ ì„¤ì • (ëª¨ë“  ë…¸ë“œ ë™ì¼)
      # MINIO_BROWSER: on                            # ì›¹ ë¸Œë¼ìš°ì € ì¸í„°í˜ì´ìŠ¤ í™œì„±í™”
      # MINIO_DOMAIN: minio.local                    # ë„ë©”ì¸ ì„¤ì •
      # MINIO_SERVER_URL: http://minio1:9000         # ì´ ë…¸ë“œì˜ ì„œë²„ URL

      # ğŸ“ ë¶„ì‚° ëª¨ë“œ ê³ ê¸‰ ì„¤ì •
      # MINIO_ERASURE_SET_DRIVE_COUNT: 4             # Erasure Setë‹¹ ë“œë¼ì´ë¸Œ ìˆ˜
      # MINIO_STORAGE_CLASS_STANDARD: EC:2           # í‘œì¤€ ìŠ¤í† ë¦¬ì§€ í´ë˜ìŠ¤ (2 íŒ¨ë¦¬í‹°)
      # MINIO_STORAGE_CLASS_RRS: EC:1                # Reduced Redundancy (1 íŒ¨ë¦¬í‹°)
    # ğŸ”„ ë¶„ì‚° ëª¨ë“œ command: ëª¨ë“  ë…¸ë“œì˜ ì—”ë“œí¬ì¸íŠ¸ ì§€ì •
    command: server http://minio{1...4}:9000/data --console-address ":9001"
    ports:
      - "8180:9000"  # S3 API (ì§ì ‘ ì ‘ê·¼)
      - "8181:9001"  # ì›¹ ì½˜ì†” (ì§ì ‘ ì ‘ê·¼)
    volumes:
      - ./data/minio1:/data    # ë…¸ë“œ1 ì „ìš© ë°ì´í„° ë””ë ‰í† ë¦¬
    networks: [ocean-net-data]

  minio2:
    image: minio/minio:latest
    restart: unless-stopped
    hostname: minio2
    container_name: minio2
    environment:
      MINIO_ROOT_USER: ${MINIO_ROOT_USER}           # ë…¸ë“œ1ê³¼ ë™ì¼í•œ ì¸ì¦ ì •ë³´
      MINIO_ROOT_PASSWORD: ${MINIO_ROOT_PASSWORD}
      MINIO_PROMETHEUS_AUTH_TYPE: public
      MINIO_PROMETHEUS_URL: http://prometheus:9090
    command: server http://minio{1...4}:9000/data --console-address ":9001"
    ports:
      - "127.0.0.1:9002:9000"  # S3 API (ë‹¤ë¥¸ í¬íŠ¸)
      - "127.0.0.1:9003:9001"  # ì›¹ ì½˜ì†” (ë‹¤ë¥¸ í¬íŠ¸)
    volumes:
      - ./data/minio2:/data    # ë…¸ë“œ2 ì „ìš© ë°ì´í„° ë””ë ‰í† ë¦¬
    networks: [ocean-net-data]

  minio3:
    image: minio/minio:latest
    restart: unless-stopped
    hostname: minio3
    container_name: minio3
    environment:
      MINIO_ROOT_USER: ${MINIO_ROOT_USER}
      MINIO_ROOT_PASSWORD: ${MINIO_ROOT_PASSWORD}
      MINIO_PROMETHEUS_AUTH_TYPE: public
      MINIO_PROMETHEUS_URL: http://prometheus:9090
    command: server http://minio{1...4}:9000/data --console-address ":9001"
    ports:
      - "127.0.0.1:9004:9000"  # S3 API (ë‹¤ë¥¸ í¬íŠ¸)
      - "127.0.0.1:9005:9001"  # ì›¹ ì½˜ì†” (ë‹¤ë¥¸ í¬íŠ¸)
    volumes:
      - ./data/minio3:/data    # ë…¸ë“œ3 ì „ìš© ë°ì´í„° ë””ë ‰í† ë¦¬
    networks: [ocean-net-data]

  minio4:
    image: minio/minio:latest
    restart: unless-stopped
    hostname: minio4
    container_name: minio4
    environment:
      MINIO_ROOT_USER: ${MINIO_ROOT_USER}
      MINIO_ROOT_PASSWORD: ${MINIO_ROOT_PASSWORD}
      MINIO_PROMETHEUS_AUTH_TYPE: public
      MINIO_PROMETHEUS_URL: http://prometheus:9090
    command: server http://minio{1...4}:9000/data --console-address ":9001"
    ports:
      - "127.0.0.1:9006:9000"  # S3 API (ë‹¤ë¥¸ í¬íŠ¸)
      - "127.0.0.1:9007:9001"  # ì›¹ ì½˜ì†” (ë‹¤ë¥¸ í¬íŠ¸)
    volumes:
      - ./data/minio4:/data    # ë…¸ë“œ4 ì „ìš© ë°ì´í„° ë””ë ‰í† ë¦¬
    networks: [ocean-net-data]

  # ğŸ”„ MinIO ë¡œë“œë°¸ëŸ°ì„œ (HAProxy ë˜ëŠ” nginx ì‚¬ìš© ê¶Œì¥)
  # minio-lb:
  #   image: haproxy:latest
  #   container_name: minio-lb
  #   restart: unless-stopped
  #   ports:
  #     - "127.0.0.1:9008:9000"  # í†µí•© S3 API ì—”ë“œí¬ì¸íŠ¸
  #   volumes:
  #     - ./config/haproxy.cfg:/usr/local/etc/haproxy/haproxy.cfg  # ë¡œë“œë°¸ëŸ°ì„œ ì„¤ì •
  #   networks: [ocean-net-data]
  #   depends_on: [minio1, minio2, minio3, minio4]

  # ğŸ”„ ì¹´í”„ì¹´ ì‹±í¬ ì»¤ë„¥í„° (MinIO ìë™ ì „ì†¡)
  kafka-sink:
    build:
      context: .
      dockerfile: Dockerfile.kafka-sink
    restart: unless-stopped
    depends_on: [kafka1, kafka2, minio1, minio2]
    hostname: kafka-sink
    container_name: kafka-sink
    ports: ["127.0.0.1:8084:8083"]
    environment:
      # ì¹´í”„ì¹´ ì‹±í¬ ì»¤ë„¥í„° ì„¤ì • (2ê°œ ë¸Œë¡œì»¤ ì—°ê²°)
      CONNECT_BOOTSTRAP_SERVERS: kafka1:29092,kafka2:29092
      CONNECT_REST_ADVERTISED_HOST_NAME: kafka-sink
      CONNECT_GROUP_ID: kafka-sink-cluster

      # ì¹´í”„ì¹´ ì‹±í¬ìš© ë‚´ë¶€ í† í”½ (ê¸°ì¡´ í† í”½ ì¬ì‚¬ìš©)
      CONNECT_CONFIG_STORAGE_TOPIC: _log-distributor-configs
      CONNECT_OFFSET_STORAGE_TOPIC: _log-distributor-offsets
      CONNECT_STATUS_STORAGE_TOPIC: _log-distributor-status

      CONNECT_CONFIG_STORAGE_REPLICATION_FACTOR: 1
      CONNECT_OFFSET_STORAGE_REPLICATION_FACTOR: 1
      CONNECT_STATUS_STORAGE_REPLICATION_FACTOR: 1

      # JSON í¬ë§· (ë¡œê·¸ ë°ì´í„°ìš©)
      CONNECT_KEY_CONVERTER: org.apache.kafka.connect.storage.StringConverter
      CONNECT_VALUE_CONVERTER: org.apache.kafka.connect.json.JsonConverter
      CONNECT_VALUE_CONVERTER_SCHEMAS_ENABLE: false

      CONNECT_PLUGIN_PATH: /usr/share/java,/usr/share/confluent-hub-components

      # ğŸ”„ ì»¤ë„¥í„° ìë™ ìƒì„± ì„¤ì •
      CONNECT_CONNECTOR_CLIENT_CONFIG_OVERRIDE_POLICY: All
    volumes:
      - ./config/connectors:/etc/kafka-connect/connectors  # ì»¤ë„¥í„° ì„¤ì • íŒŒì¼ë“¤ ë§ˆìš´íŠ¸
    networks: [ocean-net-data]

  # ğŸ“Š ë¡œê·¸ ë¶„ì‚° ì²˜ë¦¬ ëª¨ë‹ˆí„°ë§
  # log-monitor:
  #   image: prom/prometheus:latest
  #   container_name: log-monitor
  #   restart: unless-stopped
  #   ports: ["127.0.0.1:9090:9090"]
  #   volumes:
  #     - ./config/prometheus.yml:/etc/prometheus/prometheus.yml
  #   networks: [ocean-net-data]
  #   # ğŸ“ ëª¨ë‹ˆí„°ë§ ëŒ€ìƒ:
  #   # - ì¹´í”„ì¹´ íŒŒí‹°ì…˜ë³„ ë©”ì‹œì§€ ìˆ˜
  #   # - MinIO ì„œë²„ë³„ ì €ì¥ëŸ‰
  #   # - ì»¤ë„¥í„° ì²˜ë¦¬ ì†ë„

  # ğŸ“Œ ì‹¤ì œ ë¶„ì‚° í™˜ê²½ì—ì„œëŠ” ê° ë…¸ë“œë¥¼ ë‹¤ë¥¸ ë¬¼ë¦¬ ì„œë²„ì— ë°°ì¹˜
  # ì˜ˆì‹œ: docker-compose-minio-node1.yml, docker-compose-minio-node2.yml ë“±ìœ¼ë¡œ ë¶„ë¦¬
  # command ì˜ˆì‹œ: server http://server1:9000/data http://server2:9000/data http://server3:9000/data http://server4:9000/data

  # ğŸš€ Kafka ì´ˆê¸°í™” ì„œë¹„ìŠ¤
  kafka-init:
    image: confluentinc/cp-kafka:7.6.1
    container_name: kafka-init
    depends_on: [kafka1, kafka2]
    volumes:
      - ./config/init-kafka.sh:/opt/init-kafka.sh
    command: ["bash", "/opt/init-kafka.sh"]
    networks: [ocean-net-data]
    restart: "no"  # í•œ ë²ˆë§Œ ì‹¤í–‰

  # âœ… kafka-sink-connector ì œê±°ë¨ (ì‚¬ìš©í•˜ì§€ ì•ŠìŒ)
  # í˜„ì¬ kafka-sink ì»¨í…Œì´ë„ˆë§Œ ì‚¬ìš© ì¤‘

  spark-master:
    image: bitnami/spark:3.5.1
    container_name: spark-master
    restart: unless-stopped
    environment:
      # ìŠ¤íŒŒí¬ ë§ˆìŠ¤í„° ì„¤ì •
      SPARK_MODE: master                            # ë§ˆìŠ¤í„° ëª¨ë“œë¡œ ì‹¤í–‰

      # ğŸ“ ì¶”ê°€ ê°€ëŠ¥í•œ ë§ˆìŠ¤í„° ì„¤ì •
      # SPARK_MASTER_HOST: spark-master              # ë§ˆìŠ¤í„° í˜¸ìŠ¤íŠ¸ëª… (ê¸°ë³¸ê°’: ì»¨í…Œì´ë„ˆëª…)
      # SPARK_MASTER_PORT: 7077                      # ë§ˆìŠ¤í„° í¬íŠ¸ (ê¸°ë³¸ê°’ 7077)
      # SPARK_MASTER_WEBUI_PORT: 8080                # ì›¹ UI í¬íŠ¸ (ê¸°ë³¸ê°’ 8080)
      # SPARK_MASTER_OPTS: "-Dspark.deploy.recoveryMode=ZOOKEEPER"  # ê³ ê°€ìš©ì„± ì„¤ì •

      # ğŸ“ ì¶”ê°€ ê°€ëŠ¥í•œ ë¦¬ì†ŒìŠ¤ ì„¤ì •
      # SPARK_DAEMON_MEMORY: 1G                      # ë§ˆìŠ¤í„° ë°ëª¬ ë©”ëª¨ë¦¬
      # SPARK_WORKER_TIMEOUT: 60                     # ì›Œì»¤ íƒ€ì„ì•„ì›ƒ (ì´ˆ)

      # ğŸ“ ì¶”ê°€ ê°€ëŠ¥í•œ ë¡œê¹… ì„¤ì •
      # SPARK_LOG_LEVEL: INFO                        # ë¡œê·¸ ë ˆë²¨ (ERROR, WARN, INFO, DEBUG)
    ports:
      - "127.0.0.1:8080:8080"  # ìŠ¤íŒŒí¬ ë§ˆìŠ¤í„° ì›¹ UI (ë¡œì»¬)
      - "7077:7077"            # ìŠ¤íŒŒí¬ ë§ˆìŠ¤í„° RPC í¬íŠ¸
    networks: [ocean-net-data]
    # ğŸ“ ì¶”ê°€ ê°€ëŠ¥í•œ ë³¼ë¥¨ ë§ˆìš´íŠ¸
    # volumes:
    #   - ./data/spark-master:/opt/bitnami/spark/logs  # ë§ˆìŠ¤í„° ë¡œê·¸ ì €ì¥

  spark-worker:
    image: bitnami/spark:3.5.1
    container_name: spark-worker
    restart: unless-stopped
    depends_on: [spark-master]
    environment:
      # ìŠ¤íŒŒí¬ ì›Œì»¤ ì„¤ì •
      SPARK_MODE: worker                            # ì›Œì»¤ ëª¨ë“œë¡œ ì‹¤í–‰
      SPARK_MASTER_URL: spark://spark-master:7077  # ë§ˆìŠ¤í„° ì—°ê²° URL
      SPARK_WORKER_MEMORY: 2G                      # ì›Œì»¤ ë©”ëª¨ë¦¬ í• ë‹¹
      SPARK_WORKER_CORES: 2                        # ì›Œì»¤ CPU ì½”ì–´ ìˆ˜

      # ğŸ“ ì¶”ê°€ ê°€ëŠ¥í•œ ì›Œì»¤ ì„¤ì •
      # SPARK_WORKER_PORT: 8881                      # ì›Œì»¤ í¬íŠ¸ (ê¸°ë³¸ê°’ ëœë¤)
      # SPARK_WORKER_WEBUI_PORT: 8081                # ì›Œì»¤ ì›¹ UI í¬íŠ¸
      # SPARK_WORKER_DIR: /opt/bitnami/spark/work    # ì›Œì»¤ ì‘ì—… ë””ë ‰í† ë¦¬
      # SPARK_WORKER_OPTS: "-Dspark.worker.cleanup.enabled=true"  # ì›Œì»¤ ì˜µì…˜

      # ğŸ“ ì¶”ê°€ ê°€ëŠ¥í•œ ì‹¤í–‰ì ì„¤ì •
      # SPARK_EXECUTOR_MEMORY: 1G                    # ì‹¤í–‰ì ë©”ëª¨ë¦¬
      # SPARK_EXECUTOR_CORES: 1                      # ì‹¤í–‰ì ì½”ì–´ ìˆ˜
      # SPARK_EXECUTOR_INSTANCES: 2                  # ì‹¤í–‰ì ì¸ìŠ¤í„´ìŠ¤ ìˆ˜

      # ğŸ“ ì¶”ê°€ ê°€ëŠ¥í•œ ì„±ëŠ¥ ì„¤ì •
      # SPARK_DAEMON_MEMORY: 512M                    # ì›Œì»¤ ë°ëª¬ ë©”ëª¨ë¦¬
      # SPARK_WORKER_TIMEOUT: 60                     # ì›Œì»¤ ì‘ë‹µ íƒ€ì„ì•„ì›ƒ
    networks: [ocean-net-data]
    # ğŸ“ ì¶”ê°€ ê°€ëŠ¥í•œ ì„¤ì •
    # ports:
    #   - "127.0.0.1:8081:8081"  # ì›Œì»¤ ì›¹ UI (ë¡œì»¬)
    # volumes:
    #   - ./data/spark-worker:/opt/bitnami/spark/work  # ì›Œì»¤ ì‘ì—… ë””ë ‰í† ë¦¬
    #   - ./data/spark-worker-logs:/opt/bitnami/spark/logs  # ì›Œì»¤ ë¡œê·¸

  kafka-ui:
    image: provectuslabs/kafka-ui:latest
    container_name: kafka-ui
    restart: unless-stopped
    depends_on: [kafka1, kafka2]
    ports:
      - "127.0.0.1:8082:8080"  # Kafka UI ì›¹ ì¸í„°í˜ì´ìŠ¤ (ë¡œì»¬)
    environment:
      # ì¹´í”„ì¹´ í´ëŸ¬ìŠ¤í„° ì„¤ì • (2ê°œ ë¸Œë¡œì»¤)
      KAFKA_CLUSTERS_0_NAME: local-cluster                                # í´ëŸ¬ìŠ¤í„° í‘œì‹œëª…
      KAFKA_CLUSTERS_0_BOOTSTRAPSERVERS: kafka1:29092,kafka2:29092       # ì¹´í”„ì¹´ ë¸Œë¡œì»¤ 2ê°œ ì£¼ì†Œ
      KAFKA_CLUSTERS_0_ZOOKEEPER: zookeeper:2181                          # ì£¼í‚¤í¼ ì—°ê²° (í† í”½ ê´€ë¦¬ìš©)

      # ì¹´í”„ì¹´ ì»¤ë„¥íŠ¸ ì—°ë™ ì„¤ì •
      KAFKA_CLUSTERS_0_KAFKACONNECT_0_NAME: connect                       # ì»¤ë„¥íŠ¸ í´ëŸ¬ìŠ¤í„°ëª…
      KAFKA_CLUSTERS_0_KAFKACONNECT_0_ADDRESS: http://kafka-sink:8083  # ì»¤ë„¥íŠ¸ REST API ì£¼ì†Œ

      # ì›¹ ì„œë²„ ì„¤ì •
      SERVER_SERVLET_CONTEXT_PATH: /kafka-ui                              # URL ì»¨í…ìŠ¤íŠ¸ íŒ¨ìŠ¤

      # ğŸ“ ì¶”ê°€ ê°€ëŠ¥í•œ UI ì„¤ì •
      # KAFKA_CLUSTERS_0_READONLY: false                                  # ì½ê¸° ì „ìš© ëª¨ë“œ (ê¸°ë³¸ê°’ false)
      # KAFKA_CLUSTERS_0_PROPERTIES_SECURITY_PROTOCOL: PLAINTEXT          # ë³´ì•ˆ í”„ë¡œí† ì½œ

      # ğŸ“ ì¶”ê°€ ê°€ëŠ¥í•œ ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì„¤ì •
      # KAFKA_CLUSTERS_0_SCHEMAREGISTRY: http://schema-registry:8081      # ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì£¼ì†Œ
      # KAFKA_CLUSTERS_0_SCHEMANAMETEMPLATE: "%s-value"                   # ìŠ¤í‚¤ë§ˆ ë„¤ì´ë° í…œí”Œë¦¿

      # ğŸ“ ì¶”ê°€ ê°€ëŠ¥í•œ KSQL ì„¤ì •
      # KAFKA_CLUSTERS_0_KSQLDBSERVER: http://ksqldb:8088                 # KSQL DB ì„œë²„ ì£¼ì†Œ

      # ğŸ“ ì¶”ê°€ ê°€ëŠ¥í•œ ë³´ì•ˆ ì„¤ì •
      # AUTH_TYPE: LOGIN_FORM                                             # ì¸ì¦ ë°©ì‹ (DISABLED, LOGIN_FORM, OAUTH2, LDAP)
      # SPRING_SECURITY_USER_NAME: admin                                  # ê¸°ë³¸ ì‚¬ìš©ìëª…
      # SPRING_SECURITY_USER_PASSWORD: admin                              # ê¸°ë³¸ ë¹„ë°€ë²ˆí˜¸

      # ğŸ“ ì¶”ê°€ ê°€ëŠ¥í•œ ë©”íŠ¸ë¦­ ì„¤ì •
      # KAFKA_CLUSTERS_0_METRICS_PORT: 9997                              # JMX ë©”íŠ¸ë¦­ í¬íŠ¸
      # MANAGEMENT_METRICS_EXPORT_PROMETHEUS_ENABLED: true               # í”„ë¡œë©”í…Œìš°ìŠ¤ ë©”íŠ¸ë¦­ í™œì„±í™”
    networks: [ocean-net-data]

networks:
  ocean-net-data:
    external: true

